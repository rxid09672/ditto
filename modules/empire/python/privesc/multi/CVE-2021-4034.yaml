name: Pwnkit (CVE-2021-4034)
authors:
  - name: Anthony Rose
    handle: '@Cx01N'
    link: https://twitter.com/@Cx01N_
description: |
  Exploits CVE-2021-4034 (PwnKit) to achieve local privilege escalation on
  Linux systems with vulnerable polkit installations. The vulnerability exists
  in the pkexec utility and allows unprivileged users to execute arbitrary
  commands with root privileges. This module leverages the memory corruption
  vulnerability in polkit's argument parsing to bypass security restrictions
  and gain elevated privileges. The exploit terminates the existing agent
  process and spawns a new high-integrity agent with root privileges.
  Affects systems with polkit versions prior to 0.105-26ubuntu1.2.
software: ''
tactics: []
techniques:
  - T1050
background: false
output_extension: ''
needs_admin: false
opsec_safe: true
language: python
min_language_version: '3'
comments: []
options:
  - name: Agent
    description: Agent to execute module on.
    required: true
    value: ''
  - name: Listener
    description: Listener to use.
    required: true
    value: ''
  - name: SafeChecks
    description: Enable SafeChecks.
    required: true
    value: 'True'
    strict: true
    suggested_values:
      - True
      - False
  - name: UserAgent
    description: User-agent string to use for the staging request (default, none,
      or other).
    required: false
    value: default
script_path: python/privesc/CVE-2021-4034.py
advanced:
  custom_generate: true
