name: Invoke-EternalBlue
authors:
  - name: Sean Dillon <sean.dillon [at] risksense.com>
    handle: ''
    link: ''
  - name: Dylan Davis <dylan.davis [at] risksense.com>Equation Group
    handle: ''
    link: ''
  - name: kdick@tevora.com (e0x70i)
    handle: ''
    link: ''
description: |
  Exploits MS17-010 (EternalBlue) vulnerability in SMBv1 to execute arbitrary
  shellcode on vulnerable Windows systems. Targets Windows 7 and Windows Server
  2008 R2 systems that have not been patched against the SMB vulnerability.
  Leverages a kernel-level exploit to achieve remote code execution without
  authentication. Supports custom shellcode injection and configurable exploit
  parameters including groom attempts and initial groom count. Note: This exploit
  has a potential for causing system crashes (BSOD) and should be used with caution.
software: ''
tactics: [TA0008]
techniques: [T1210]
background: false
output_extension:
needs_admin: false
opsec_safe: false
language: powershell
min_language_version: '2'
comments:
  - https://github.com/RiskSense-Ops/MS17-010
  - https://www.rapid7.com/db/modules/exploit/windows/smb/ms17_010_eternalblue
  - http://threat.tevora.com/eternal-blues/
options:
  - name: Agent
    description: Agent to run module on.
    required: true
    value: ''
  - name: Target
    description: 'IP or Hostname of target '
    required: true
    value: ''
  - name: MaxAttempts
    description: Number of times to try exploit (increment grooms by 5 each time)
    required: true
    value: '1'
  - name: InitialGrooms
    description: Number of Initial Grooms
    required: true
    value: '12'
  - name: Shellcode
    description: Custom shellcode to inject, 0xaa,0xab,... format.
    required: true
    value: ''
script_path: exploitation/Exploit-EternalBlue.ps1
advanced:
  custom_generate: true
